-- é»‘è‰²ä¸»é¢˜å¼€å‘è€…å·¥å…· - åŒ…å«ç‰©ä½“å˜è‰²å’Œé»‘å®¢ç³»ç»Ÿ
-- ä»…ä¾›Roblox Studioåˆ›ä½œä½¿ç”¨
-- ä¿å­˜ä¸ºLocalScriptæ”¾å…¥StarterGui

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Lighting = game:GetService("Lighting")
local TweenService = game:GetService("TweenService")
local Workspace = game:GetService("Workspace")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- é¢œè‰²ä¸»é¢˜é…ç½®
local theme = {
    darkRed = Color3.fromRGB(15, 0, 0),
    red = Color3.fromRGB(255, 50, 50),
    brightRed = Color3.fromRGB(255, 0, 0),
    black = Color3.fromRGB(0, 0, 0),
    darkGray = Color3.fromRGB(20, 20, 20)
}

-- çŠ¶æ€å˜é‡
local isThemeActive = false
local originalColors = {}
local activeParticles = {}
local originalMaterials = {}
local activeSurfaceGuis = {}

-- ç¼©æ”¾çŠ¶æ€å˜é‡
local isMinimized = false
local originalSize = UDim2.new(0, 450, 0, 350)
local minimizedSize = UDim2.new(0, 200, 0, 35)
local originalPosition = UDim2.new(0.5, -225, 0.5, -175)

-- åˆ›å»ºä¸»UI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "HackerMenu"
ScreenGui.ResetOnSpawn = false
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.DisplayOrder = 999

-- ä¸»çª—å£
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = originalSize
MainFrame.Position = originalPosition
MainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
MainFrame.BackgroundColor3 = theme.darkRed
MainFrame.BorderColor3 = Color3.fromRGB(80, 0, 0)
MainFrame.BorderSizePixel = 3
MainFrame.BackgroundTransparency = 0.15

-- æ ‡é¢˜æ 
local TitleBar = Instance.new("Frame")
TitleBar.Name = "TitleBar"
TitleBar.Size = UDim2.new(1, 0, 0, 35)
TitleBar.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
TitleBar.BorderColor3 = Color3.fromRGB(150, 0, 0)

local TitleText = Instance.new("TextLabel")
TitleText.Name = "TitleText"
TitleText.Size = UDim2.new(1, -100, 1, 0)
TitleText.Position = UDim2.new(0, 10, 0, 0)
TitleText.BackgroundTransparency = 1
TitleText.Text = "é»‘å®¢èœå•"
TitleText.TextColor3 = theme.red
TitleText.Font = Enum.Font.GothamBold
TitleText.TextSize = 16
TitleText.TextXAlignment = Enum.TextXAlignment.Left

local MinimizeButton = Instance.new("TextButton")
MinimizeButton.Name = "MinimizeButton"
MinimizeButton.Size = UDim2.new(0, 30, 0, 30)
MinimizeButton.Position = UDim2.new(1, -70, 0.5, -15)
MinimizeButton.AnchorPoint = Vector2.new(0, 0.5)
MinimizeButton.BackgroundColor3 = Color3.fromRGB(40, 0, 0)
MinimizeButton.BorderColor3 = Color3.fromRGB(100, 0, 0)
MinimizeButton.Text = "_"
MinimizeButton.TextColor3 = theme.red
MinimizeButton.Font = Enum.Font.GothamBold
MinimizeButton.TextSize = 16
MinimizeButton.ZIndex = 10

local CloseButton = Instance.new("TextButton")
CloseButton.Name = "CloseButton"
CloseButton.Size = UDim2.new(0, 30, 0, 30)
CloseButton.Position = UDim2.new(1, -30, 0.5, -15)
CloseButton.AnchorPoint = Vector2.new(0, 0.5)
CloseButton.BackgroundColor3 = Color3.fromRGB(40, 0, 0)
CloseButton.BorderColor3 = Color3.fromRGB(100, 0, 0)
CloseButton.Text = "âœ•"
CloseButton.TextColor3 = theme.red
CloseButton.Font = Enum.Font.GothamBold
CloseButton.TextSize = 16
CloseButton.ZIndex = 10

-- å†…å®¹åŒºåŸŸ
local ContentFrame = Instance.new("Frame")
ContentFrame.Name = "ContentFrame"
ContentFrame.Size = UDim2.new(1, -20, 1, -55)
ContentFrame.Position = UDim2.new(0, 10, 0, 45)
ContentFrame.BackgroundColor3 = Color3.fromRGB(10, 0, 0)
ContentFrame.BackgroundTransparency = 0.3
ContentFrame.BorderSizePixel = 0

local ThemeToggleButton = Instance.new("TextButton")
ThemeToggleButton.Name = "ThemeToggleButton"
ThemeToggleButton.Size = UDim2.new(0, 250, 0, 50)
ThemeToggleButton.Position = UDim2.new(0.5, -125, 0.1, 0)
ThemeToggleButton.BackgroundColor3 = Color3.fromRGB(30, 0, 0)
ThemeToggleButton.BorderColor3 = Color3.fromRGB(120, 0, 0)
ThemeToggleButton.BorderSizePixel = 2
ThemeToggleButton.Text = "ğŸ’» å¯åŠ¨é»‘å®¢è§†è§‰"
ThemeToggleButton.TextColor3 = theme.red
ThemeToggleButton.Font = Enum.Font.GothamBold
ThemeToggleButton.TextSize = 18

local StatusLabel = Instance.new("TextLabel")
StatusLabel.Name = "StatusLabel"
StatusLabel.Size = UDim2.new(0.8, 0, 0, 30)
StatusLabel.Position = UDim2.new(0.1, 0, 0.3, 0)
StatusLabel.BackgroundTransparency = 1
StatusLabel.Text = "ç³»ç»ŸçŠ¶æ€: å¾…æœºä¸­"
StatusLabel.TextColor3 = Color3.fromRGB(200, 100, 100)
StatusLabel.Font = Enum.Font.Gotham
StatusLabel.TextSize = 14

-- ç‰¹æ•ˆè®¾ç½®
local SettingsFrame = Instance.new("Frame")
SettingsFrame.Name = "SettingsFrame"
SettingsFrame.Size = UDim2.new(0.9, 0, 0, 150)
SettingsFrame.Position = UDim2.new(0.05, 0, 0.45, 0)
SettingsFrame.BackgroundColor3 = Color3.fromRGB(15, 0, 0)
SettingsFrame.BorderColor3 = Color3.fromRGB(60, 0, 0)

local SettingsTitle = Instance.new("TextLabel")
SettingsTitle.Name = "SettingsTitle"
SettingsTitle.Size = UDim2.new(1, 0, 0, 25)
SettingsTitle.BackgroundColor3 = Color3.fromRGB(25, 0, 0)
SettingsTitle.BorderColor3 = Color3.fromRGB(80, 0, 0)
SettingsTitle.Text = "âš™ï¸ è§†è§‰å‚æ•°"
SettingsTitle.TextColor3 = theme.red
SettingsTitle.Font = Enum.Font.GothamBold
SettingsTitle.TextSize = 14

local ParticleSliderFrame = Instance.new("Frame")
ParticleSliderFrame.Name = "ParticleSliderFrame"
ParticleSliderFrame.Size = UDim2.new(1, -20, 0, 40)
ParticleSliderFrame.Position = UDim2.new(0, 10, 0, 35)
ParticleSliderFrame.BackgroundTransparency = 1

local ParticleLabel = Instance.new("TextLabel")
ParticleLabel.Name = "ParticleLabel"
ParticleLabel.Size = UDim2.new(0.6, 0, 1, 0)
ParticleLabel.BackgroundTransparency = 1
ParticleLabel.Text = "å…‰æ™•å¼ºåº¦:"
ParticleLabel.TextColor3 = Color3.fromRGB(180, 80, 80)
ParticleLabel.Font = Enum.Font.Gotham
ParticleLabel.TextSize = 12
ParticleLabel.TextXAlignment = Enum.TextXAlignment.Left

local ParticleValue = Instance.new("TextLabel")
ParticleValue.Name = "ParticleValue"
ParticleValue.Size = UDim2.new(0.3, 0, 1, 0)
ParticleValue.Position = UDim2.new(0.7, 0, 0, 0)
ParticleValue.BackgroundTransparency = 1
ParticleValue.Text = "50%"
ParticleValue.TextColor3 = theme.red
ParticleValue.Font = Enum.Font.GothamBold
ParticleValue.TextSize = 12

local ParticleSlider = Instance.new("Frame")
ParticleSlider.Name = "ParticleSlider"
ParticleSlider.Size = UDim2.new(1, 0, 0, 4)
ParticleSlider.Position = UDim2.new(0, 0, 1, 5)
ParticleSlider.BackgroundColor3 = Color3.fromRGB(40, 0, 0)
ParticleSlider.BorderSizePixel = 0

local ParticleSliderFill = Instance.new("Frame")
ParticleSliderFill.Name = "ParticleSliderFill"
ParticleSliderFill.Size = UDim2.new(0.5, 0, 1, 0)
ParticleSliderFill.BackgroundColor3 = theme.red
ParticleSliderFill.BorderSizePixel = 0

local AdvancedButton = Instance.new("TextButton")
AdvancedButton.Name = "AdvancedButton"
AdvancedButton.Size = UDim2.new(0, 180, 0, 35)
AdvancedButton.Position = UDim2.new(0.5, -90, 0.85, 0)
AdvancedButton.BackgroundColor3 = Color3.fromRGB(25, 0, 0)
AdvancedButton.BorderColor3 = Color3.fromRGB(90, 0, 0)
AdvancedButton.Text = "âš¡ é«˜çº§å·¥å…·"
AdvancedButton.TextColor3 = Color3.fromRGB(200, 100, 100)
AdvancedButton.Font = Enum.Font.Gotham
AdvancedButton.TextSize = 12

-- ç»„è£…UI
ParticleSliderFill.Parent = ParticleSlider
ParticleSlider.Parent = ParticleSliderFrame
ParticleLabel.Parent = ParticleSliderFrame
ParticleValue.Parent = ParticleSliderFrame
ParticleSliderFrame.Parent = SettingsFrame
SettingsTitle.Parent = SettingsFrame
SettingsFrame.Parent = ContentFrame
ThemeToggleButton.Parent = ContentFrame
StatusLabel.Parent = ContentFrame
AdvancedButton.Parent = ContentFrame
TitleText.Parent = TitleBar
MinimizeButton.Parent = TitleBar
CloseButton.Parent = TitleBar
TitleBar.Parent = MainFrame
ContentFrame.Parent = MainFrame
MainFrame.Parent = ScreenGui
ScreenGui.Parent = playerGui

-- UIè§†è§‰æ•ˆæœ
local glowEffect = Instance.new("UIStroke")
glowEffect.Name = "GlowEffect"
glowEffect.Color = Color3.fromRGB(150, 0, 0)
glowEffect.Thickness = 2
glowEffect.Transparency = 0.5
glowEffect.Parent = MainFrame

local innerGlow = Instance.new("UIStroke")
innerGlow.Name = "InnerGlow"
innerGlow.Color = Color3.fromRGB(80, 0, 0)
innerGlow.Thickness = 1
innerGlow.Transparency = 0.3
innerGlow.Parent = ContentFrame

-- æ–°å¢ï¼šç¼©æ”¾åŠŸèƒ½å‡½æ•°
local function toggleMinimize()
    isMinimized = not isMinimized
    
    if isMinimized then
        MainFrame.Size = minimizedSize
        ContentFrame.Visible = false
        MinimizeButton.Text = "â–¡"
        TitleText.Text = "é»‘å®¢èœå• [æœ€å°åŒ–]"
        
        MinimizeButton.Position = UDim2.new(1, -70, 0.5, -15)
        CloseButton.Position = UDim2.new(1, -30, 0.5, -15)
        
        TitleBar.Size = UDim2.new(1, 0, 1, 0)
    else
        MainFrame.Size = originalSize
        ContentFrame.Visible = true
        MinimizeButton.Text = "_"
        TitleText.Text = "é»‘å®¢èœå•"
        
        TitleBar.Size = UDim2.new(1, 0, 0, 35)
        MinimizeButton.Position = UDim2.new(1, -70, 0.5, -15)
        CloseButton.Position = UDim2.new(1, -30, 0.5, -15)
    end
    
    local tweenInfo = TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
    local sizeTween = TweenService:Create(MainFrame, tweenInfo, {
        Size = isMinimized and minimizedSize or originalSize
    })
    sizeTween:Play()
    
    local buttonTweenInfo = TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
    local buttonTween = TweenService:Create(MinimizeButton, buttonTweenInfo, {
        BackgroundColor3 = isMinimized and Color3.fromRGB(60, 0, 0) or Color3.fromRGB(40, 0, 0)
    })
    buttonTween:Play()
    
    print(isMinimized and "ğŸ“± èœå•å·²æœ€å°åŒ–" or "ğŸ–¥ï¸ èœå•å·²æœ€å¤§åŒ–")
end

-- å¯æ‹–åŠ¨åŠŸèƒ½
local dragging = false
local dragInput, dragStart, startPos

local function update(input)
    local delta = input.Position - dragStart
    MainFrame.Position = UDim2.new(
        startPos.X.Scale, 
        startPos.X.Offset + delta.X, 
        startPos.Y.Scale, 
        startPos.Y.Offset + delta.Y
    )
end

TitleBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = MainFrame.Position
        
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

TitleBar.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if dragging and input == dragInput then
        update(input)
    end
end)

-- åˆ›å»ºé»‘æ ¸çº¢è¾¹å‘å…‰ç²’å­ç‰¹æ•ˆå‡½æ•°
local function createBlackCoreRedEdgeParticleEffect(part)
    if not part:IsA("BasePart") then return nil end
    
    -- ä¿®å¤ï¼šæ£€æŸ¥partæ˜¯å¦æœ‰æ•ˆ
    if not part:IsDescendantOf(Workspace) then return nil end
    
    -- ä¸»ç²’å­å‘å°„å™¨ - é»‘æ ¸çº¢è¾¹æ•ˆæœ
    local mainEmitter = Instance.new("ParticleEmitter")
    mainEmitter.Name = "CoreEdgeParticles"
    
    -- é»‘æ ¸çº¢è¾¹çš„é¢œè‰²åºåˆ—
    mainEmitter.Color = ColorSequence.new({
        -- ç²’å­ä¸­å¿ƒä¸ºé»‘è‰²ï¼Œè¾¹ç¼˜ä¸ºçº¢è‰²
        ColorSequenceKeypoint.new(0.0, Color3.fromRGB(0, 0, 0)),      -- çº¯é»‘ä¸­å¿ƒ
        ColorSequenceKeypoint.new(0.3, Color3.fromRGB(50, 0, 0)),    -- æš—çº¢è¿‡æ¸¡
        ColorSequenceKeypoint.new(0.7, Color3.fromRGB(150, 0, 0)),   -- ä¸­çº¢è¾¹ç¼˜
        ColorSequenceKeypoint.new(1.0, Color3.fromRGB(255, 0, 0))    -- äº®çº¢å¤–ç¼˜
    })
    
    -- å°ºå¯¸å˜åŒ– - ä»ä¸­å¿ƒå‘å¤–æ‰©å±•
    mainEmitter.Size = NumberSequence.new({
        NumberSequenceKeypoint.new(0.0, 0),      -- ä»æ— å¼€å§‹
        NumberSequenceKeypoint.new(0.2, 1.5),    -- å¿«é€Ÿæ‰©å±•
        NumberSequenceKeypoint.new(0.5, 3.0),    -- æœ€å¤§å°ºå¯¸
        NumberSequenceKeypoint.new(0.8, 2.0),    -- å¼€å§‹æ”¶ç¼©
        NumberSequenceKeypoint.new(1.0, 0)       -- å®Œå…¨æ¶ˆå¤±
    })
    
    -- é€æ˜åº¦å˜åŒ– - åˆ›é€ å‘å…‰è¾¹ç¼˜æ•ˆæœ
    mainEmitter.Transparency = NumberSequence.new({
        NumberSequenceKeypoint.new(0.0, 0.8),    -- ä¸­å¿ƒè¾ƒé€æ˜
        NumberSequenceKeypoint.new(0.3, 0.4),    -- è¾¹ç¼˜å¼€å§‹æ˜¾ç°
        NumberSequenceKeypoint.new(0.6, 0.1),    -- æœ€äº®è¾¹ç¼˜
        NumberSequenceKeypoint.new(0.9, 0.4),    -- è¾¹ç¼˜å¼€å§‹æ¶ˆæ•£
        NumberSequenceKeypoint.new(1.0, 0.8)     -- å®Œå…¨é€æ˜
    })
    
    -- è¾ƒé•¿çš„ç”Ÿå‘½å‘¨æœŸï¼Œå±•ç¤ºå®Œæ•´çš„é¢œè‰²æ¸å˜
    mainEmitter.Lifetime = NumberRange.new(1.5, 2.5)
    
    -- é€‚ä¸­çš„å‘å°„ç‡
    mainEmitter.Rate = 25
    
    -- æ—‹è½¬æ•ˆæœ
    mainEmitter.Rotation = NumberRange.new(0, 360)
    
    -- ç¼“æ…¢å‘ä¸Šé£˜åŠ¨
    mainEmitter.Speed = NumberRange.new(1, 3)
    
    -- è¾ƒçª„çš„æ•£å¸ƒè§’åº¦ï¼Œåˆ›é€ æ›´é›†ä¸­çš„æ•ˆæœ
    mainEmitter.VelocitySpread = 30
    
    -- å‘ä¸ŠåŠ é€Ÿåº¦
    mainEmitter.Acceleration = Vector3.new(0, 4, 0)
    
    -- ä»ä¸Šæ–¹å‘ä¸‹å‘å°„
    mainEmitter.EmissionDirection = Enum.NormalId.Top
    
    -- è¾ƒå¼ºçš„ç¯å…‰æ•ˆæœï¼Œä½¿çº¢è¾¹å‘å…‰
    mainEmitter.LightEmission = 0.9
    mainEmitter.LightInfluence = 0
    
    -- ç²’å­å½¢çŠ¶
    mainEmitter.Shape = Enum.ParticleEmitterShape.Box
    mainEmitter.ShapeStyle = Enum.ParticleEmitterShapeStyle.Surface
    
    mainEmitter.Enabled = true
    mainEmitter.Parent = part
    
    -- ç¬¬äºŒä¸ªå‘å°„å™¨ - åˆ›é€ çº¢è‰²å…‰æ™•æ•ˆæœ
    local glowEmitter = Instance.new("ParticleEmitter")
    glowEmitter.Name = "RedGlowParticles"
    
    -- çº¯çº¢è‰²å…‰æ™•
    glowEmitter.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0.0, Color3.fromRGB(255, 50, 50)),
        ColorSequenceKeypoint.new(0.5, Color3.fromRGB(255, 100, 100)),
        ColorSequenceKeypoint.new(1.0, Color3.fromRGB(255, 50, 50))
    })
    
    -- è¾ƒå¤§çš„å…‰æ™•å°ºå¯¸
    glowEmitter.Size = NumberSequence.new({
        NumberSequenceKeypoint.new(0.0, 0),
        NumberSequenceKeypoint.new(0.3, 4),
        NumberSequenceKeypoint.new(0.7, 6),
        NumberSequenceKeypoint.new(1.0, 0)
    })
    
    -- é«˜åº¦é€æ˜çš„å…‰æ™•
    glowEmitter.Transparency = NumberSequence.new({
        NumberSequenceKeypoint.new(0.0, 0.7),
        NumberSequenceKeypoint.new(0.5, 0.4),
        NumberSequenceKeypoint.new(1.0, 0.9)
    })
    
    -- è¾ƒçŸ­çš„ç”Ÿå‘½å‘¨æœŸ
    glowEmitter.Lifetime = NumberRange.new(0.8, 1.5)
    
    -- è¾ƒä½çš„å…‰æ™•å‘å°„ç‡
    glowEmitter.Rate = 15
    
    -- æ— æ—‹è½¬
    glowEmitter.Rotation = NumberRange.new(0, 0)
    
    -- æ›´æ…¢çš„é€Ÿåº¦
    glowEmitter.Speed = NumberRange.new(0.5, 1.5)
    
    -- å®½æ•£å¸ƒè§’åº¦
    glowEmitter.VelocitySpread = 60
    
    -- å¼ºçƒˆçš„å‘å…‰æ•ˆæœ
    glowEmitter.LightEmission = 1.0
    glowEmitter.LightInfluence = 0
    
    glowEmitter.Enabled = true
    glowEmitter.Parent = part
    
    -- ç¬¬ä¸‰ä¸ªå‘å°„å™¨ - é»‘è‰²æ ¸å¿ƒç²’å­
    local coreEmitter = Instance.new("ParticleEmitter")
    coreEmitter.Name = "BlackCoreParticles"
    
    -- çº¯é»‘è‰²æ ¸å¿ƒ
    coreEmitter.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0.0, Color3.fromRGB(0, 0, 0)),
        ColorSequenceKeypoint.new(0.5, Color3.fromRGB(10, 0, 0)),
        ColorSequenceKeypoint.new(1.0, Color3.fromRGB(0, 0, 0))
    })
    
    -- è¾ƒå°çš„æ ¸å¿ƒå°ºå¯¸
    coreEmitter.Size = NumberSequence.new({
        NumberSequenceKeypoint.new(0.0, 0.5),
        NumberSequenceKeypoint.new(0.5, 1.0),
        NumberSequenceKeypoint.new(1.0, 0.5)
    })
    
    -- è¾ƒä½é€æ˜åº¦
    coreEmitter.Transparency = NumberSequence.new({
        NumberSequenceKeypoint.new(0.0, 0.3),
        NumberSequenceKeypoint.new(0.5, 0.1),
        NumberSequenceKeypoint.new(1.0, 0.4)
    })
    
    -- è¾ƒé•¿çš„ç”Ÿå‘½å‘¨æœŸ
    coreEmitter.Lifetime = NumberRange.new(2.0, 3.0)
    
    -- è¾ƒé«˜çš„å‘å°„ç‡
    coreEmitter.Rate = 30
    
    -- éšæœºæ—‹è½¬
    coreEmitter.Rotation = NumberRange.new(0, 360)
    
    -- ä¸­ç­‰é€Ÿåº¦
    coreEmitter.Speed = NumberRange.new(1.5, 2.5)
    
    -- çª„æ•£å¸ƒè§’åº¦
    coreEmitter.VelocitySpread = 20
    
    -- ä¸­ç­‰å‘å…‰
    coreEmitter.LightEmission = 0.3
    coreEmitter.LightInfluence = 0
    
    coreEmitter.Enabled = true
    coreEmitter.Parent = part
    
    return {core = coreEmitter, edge = mainEmitter, glow = glowEmitter}
end

-- å®‰å…¨åœ°åº”ç”¨é»‘å®¢ä¸»é¢˜åˆ°ç‰©ä½“
local function applyHackerThemeToObject(obj)
    if not obj or not obj.Parent then return end
    
    if obj:IsA("BasePart") then
        -- ä¿®å¤ï¼šä½¿ç”¨pcallé˜²æ­¢é”™è¯¯
        local success, errorMsg = pcall(function()
            -- ä¿å­˜åŸå§‹é¢œè‰²å’Œæè´¨
            originalColors[obj] = obj.Color
            originalMaterials[obj] = obj.Material
            
            -- åº”ç”¨é»‘å®¢é£æ ¼é¢œè‰²
            obj.Color = Color3.fromRGB(
                math.random(10, 30),
                math.random(0, 10),
                math.random(0, 10)
            )
            
            -- ä½¿ç”¨æœ‰ç§‘æŠ€æ„Ÿçš„æè´¨
            if obj.Material ~= Enum.Material.Neon then
                obj.Material = Enum.Material.Glass
            end
            
            -- æ·»åŠ é»‘å®¢é£æ ¼çš„å‘å…‰æ•ˆæœ
            local surfaceGui = Instance.new("SurfaceGui")
            surfaceGui.Face = Enum.NormalId.Top
            surfaceGui.AlwaysOnTop = true
            surfaceGui.LightInfluence = 0
            surfaceGui.Name = "HackerSurfaceGui"
            
            local codeFrame = Instance.new("Frame")
            codeFrame.Size = UDim2.new(1, 0, 1, 0)
            codeFrame.BackgroundColor3 = Color3.fromRGB(20, 0, 5)
            codeFrame.BackgroundTransparency = 0.6
            codeFrame.BorderSizePixel = 0
            
            -- æ·»åŠ ä¸€äº›æ¨¡æ‹Ÿä»£ç æ–‡æœ¬
            local codeText = Instance.new("TextLabel")
            codeText.Size = UDim2.new(1, 0, 1, 0)
            codeText.BackgroundTransparency = 1
            codeText.Text = "01001000\n01100001\n01100011\n01101011"
            codeText.TextColor3 = Color3.fromRGB(150, 0, 50)
            codeText.Font = Enum.Font.Code
            codeText.TextSize = 8
            codeText.TextTransparency = 0.7
            codeText.TextYAlignment = Enum.TextYAlignment.Top
            codeText.Parent = codeFrame
            
            codeFrame.Parent = surfaceGui
            surfaceGui.Parent = obj
            
            -- ä¿å­˜SurfaceGuiå¼•ç”¨
            activeSurfaceGuis[obj] = surfaceGui
            
            -- æ·»åŠ é»‘æ ¸çº¢è¾¹å‘å…‰ç²’å­ç‰¹æ•ˆ
            local particles = createBlackCoreRedEdgeParticleEffect(obj)
            if particles then
                activeParticles[obj] = particles
            end
        end)
        
        if not success then
            warn("åº”ç”¨é»‘å®¢ä¸»é¢˜åˆ°ç‰©ä½“æ—¶å‡ºé”™: " .. tostring(errorMsg))
        end
        
    elseif obj:IsA("Model") then
        for _, child in ipairs(obj:GetDescendants()) do
            applyHackerThemeToObject(child)
        end
    end
end

-- å®‰å…¨åœ°æ¢å¤åŸå§‹çŠ¶æ€
local function restoreOriginalState()
    -- æ¢å¤ç‰©ä½“é¢œè‰²å’Œæè´¨
    for obj, originalColor in pairs(originalColors) do
        if obj and obj.Parent then
            local success, errorMsg = pcall(function()
                obj.Color = originalColor
                if originalMaterials[obj] then
                    obj.Material = originalMaterials[obj]
                end
                
                -- ç§»é™¤é»‘å®¢ç‰¹æ•ˆ
                for _, child in ipairs(obj:GetChildren()) do
                    if child.Name == "CoreEdgeParticles" or 
                       child.Name == "RedGlowParticles" or 
                       child.Name == "BlackCoreParticles" or 
                       child.Name == "HackerSurfaceGui" then
                        child:Destroy()
                    end
                end
            end)
            
            if not success then
                warn("æ¢å¤ç‰©ä½“çŠ¶æ€æ—¶å‡ºé”™: " .. tostring(errorMsg))
            end
        end
    end
    
    -- æ¸…é™¤ç²’å­ç¼“å­˜
    for _, particles in pairs(activeParticles) do
        if particles.core and particles.core.Parent then particles.core:Destroy() end
        if particles.edge and particles.edge.Parent then particles.edge:Destroy() end
        if particles.glow and particles.glow.Parent then particles.glow:Destroy() end
    end
    
    -- æ¸…é™¤SurfaceGuiç¼“å­˜
    for _, surfaceGui in pairs(activeSurfaceGuis) do
        if surfaceGui and surfaceGui.Parent then
            surfaceGui:Destroy()
        end
    end
    
    -- é‡ç½®æ‰€æœ‰ç¼“å­˜
    originalColors = {}
    originalMaterials = {}
    activeParticles = {}
    activeSurfaceGuis = {}
    
    -- æ¢å¤å¤©ç©ºç›’
    local success, errorMsg = pcall(function()
        if originalColors["Lighting_Brightness"] then
            Lighting.Brightness = originalColors["Lighting_Brightness"]
            Lighting.Ambient = originalColors["Lighting_Ambient"]
            Lighting.OutdoorAmbient = originalColors["Lighting_OutdoorAmbient"]
        else
            Lighting.Brightness = 2
            Lighting.GlobalShadows = true
        end
    end)
    
    if not success then
        warn("æ¢å¤å…‰ç…§è®¾ç½®æ—¶å‡ºé”™: " .. tostring(errorMsg))
    end
end

-- å®‰å…¨åœ°åº”ç”¨å…¨å±€é»‘å®¢æ•ˆæœ
local function applyGlobalHackerTheme()
    -- ä¿å­˜å¹¶ä¿®æ”¹å…‰ç…§
    local success, errorMsg = pcall(function()
        if not originalColors["Lighting_Brightness"] then
            originalColors["Lighting_Brightness"] = Lighting.Brightness
            originalColors["Lighting_Ambient"] = Lighting.Ambient
            originalColors["Lighting_OutdoorAmbient"] = Lighting.OutdoorAmbient
        end
        
        -- è®¾ç½®é»‘å®¢é£æ ¼å…‰ç…§
        Lighting.Brightness = 0.7
        Lighting.Ambient = Color3.fromRGB(15, 0, 5)
        Lighting.OutdoorAmbient = Color3.fromRGB(10, 0, 3)
        
        -- æ·»åŠ é»‘å®¢é£æ ¼é›¾æ•ˆ
        if not Lighting:FindFirstChild("HackerFog") then
            Lighting.FogColor = Color3.fromRGB(25, 0, 10)
            Lighting.FogEnd = 600
            Lighting.FogStart = 150
        end
    end)
    
    if not success then
        warn("è®¾ç½®å…‰ç…§æ—¶å‡ºé”™: " .. tostring(errorMsg))
        return
    end
    
    -- å¤„ç†å·¥ä½œåŒºä¸­çš„æ‰€æœ‰ç‰©ä½“
    local success2, errorMsg2 = pcall(function()
        local workspaceObjects = Workspace:GetDescendants()
        local processedCount = 0
        
        for _, obj in ipairs(workspaceObjects) do
            if (obj:IsA("BasePart") or obj:IsA("Model")) and not obj:IsA("Terrain") then
                applyHackerThemeToObject(obj)
                processedCount = processedCount + 1
            end
        end
        
        print("å·²å¤„ç† " .. processedCount .. " ä¸ªç‰©ä½“")
    end)
    
    if not success2 then
        warn("å¤„ç†å·¥ä½œåŒºç‰©ä½“æ—¶å‡ºé”™: " .. tostring(errorMsg2))
    end
    
    -- ä¹Ÿå¤„ç†æœªæ¥æ·»åŠ çš„ç‰©ä½“ï¼ˆä½¿ç”¨pcallåŒ…è£…ï¼‰
    Workspace.DescendantAdded:Connect(function(descendant)
        if isThemeActive and (descendant:IsA("BasePart") or descendant:IsA("Model")) then
            pcall(function()
                applyHackerThemeToObject(descendant)
            end)
        end
    end)
end

-- é»‘å®¢è§†è§‰åˆ‡æ¢ä¸»å‡½æ•°
local function toggleHackerVision()
    isThemeActive = not isThemeActive
    
    if isThemeActive then
        ThemeToggleButton.Text = "ğŸ›‘ å…³é—­é»‘å®¢è§†è§‰"
        ThemeToggleButton.BackgroundColor3 = Color3.fromRGB(60, 0, 0)
        StatusLabel.Text = "ç³»ç»ŸçŠ¶æ€: è§†è§‰è¦†ç›–ä¸­"
        StatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
        
        print("==================================")
        print("ğŸ’» é»‘å®¢è§†è§‰ç³»ç»Ÿå·²æ¿€æ´»")
        print("æ­£åœ¨æ¤å…¥é»‘æ ¸çº¢è¾¹ç²’å­æ•ˆæœ...")
        print("å…‰æ™•æ¸²æŸ“ä¸­...")
        print("==================================")
        
        -- ä½¿ç”¨å»¶è¿Ÿé˜²æ­¢é˜»å¡
        task.spawn(function()
            applyGlobalHackerTheme()
        end)
        
        local tweenInfo = TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
        local tween = TweenService:Create(ThemeToggleButton, tweenInfo, {
            BackgroundColor3 = Color3.fromRGB(80, 0, 0)
        })
        tween:Play()
    else
        ThemeToggleButton.Text = "ğŸ’» å¯åŠ¨é»‘å®¢è§†è§‰"
        ThemeToggleButton.BackgroundColor3 = Color3.fromRGB(30, 0, 0)
        StatusLabel.Text = "ç³»ç»ŸçŠ¶æ€: å¾…æœºä¸­"
        StatusLabel.TextColor3 = Color3.fromRGB(200, 100, 100)
        
        print("==================================")
        print("ğŸ›‘ é»‘å®¢è§†è§‰ç³»ç»Ÿå·²ç»ˆæ­¢")
        print("æ­£åœ¨æ¸…é™¤ç²’å­æ•ˆæœ...")
        print("æ¢å¤é»˜è®¤æ¸²æŸ“...")
        print("==================================")
        
        -- ä½¿ç”¨å»¶è¿Ÿé˜²æ­¢é˜»å¡
        task.spawn(function()
            restoreOriginalState()
        end)
    end
end

-- å…‰æ™•å¼ºåº¦æ§åˆ¶
ParticleSliderFill.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        local connection
        connection = input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                connection:Disconnect()
            else
                local mousePos = UserInputService:GetMouseLocation()
                local sliderPos = ParticleSlider.AbsolutePosition
                local sliderSize = ParticleSlider.AbsoluteSize
                
                local relativeX = math.clamp((mousePos.X - sliderPos.X) / sliderSize.X, 0, 1)
                ParticleSliderFill.Size = UDim2.new(relativeX, 0, 1, 0)
                ParticleValue.Text = math.floor(relativeX * 100) .. "%"
                
                -- æ›´æ–°æ‰€æœ‰ç²’å­çš„å¼ºåº¦
                for obj, particles in pairs(activeParticles) do
                    if obj and obj.Parent then
                        pcall(function()
                            if particles.edge then
                                particles.edge.Rate = 15 + (relativeX * 35)
                                particles.edge.LightEmission = 0.5 + (relativeX * 0.5)
                            end
                            if particles.glow then
                                particles.glow.Rate = 10 + (relativeX * 20)
                                particles.glow.LightEmission = 0.5 + (relativeX * 0.5)
                            end
                            if particles.core then
                                particles.core.Rate = 20 + (relativeX * 40)
                            end
                        end)
                    end
                end
            end
        end)
    end
end)

-- æŒ‰é’®äº‹ä»¶
CloseButton.MouseButton1Click:Connect(function()
    ScreenGui.Enabled = false
    print("ğŸ”’ é»‘å®¢èœå•å·²éšè—")
end)

MinimizeButton.MouseButton1Click:Connect(function()
    toggleMinimize()
end)

MinimizeButton.MouseEnter:Connect(function()
    local tweenInfo = TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
    local tween = TweenService:Create(MinimizeButton, tweenInfo, {
        BackgroundColor3 = Color3.fromRGB(60, 0, 0),
        TextColor3 = Color3.fromRGB(255, 80, 80)
    })
    tween:Play()
end)

MinimizeButton.MouseLeave:Connect(function()
    local tweenInfo = TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
    local tween = TweenService:Create(MinimizeButton, tweenInfo, {
        BackgroundColor3 = isMinimized and Color3.fromRGB(60, 0, 0) or Color3.fromRGB(40, 0, 0),
        TextColor3 = theme.red
    })
    tween:Play()
end)

CloseButton.MouseEnter:Connect(function()
    local tweenInfo = TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
    local tween = TweenService:Create(CloseButton, tweenInfo, {
        BackgroundColor3 = Color3.fromRGB(80, 0, 0),
        TextColor3 = Color3.fromRGB(255, 100, 100)
    })
    tween:Play()
end)

CloseButton.MouseLeave:Connect(function()
    local tweenInfo = TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
    local tween = TweenService:Create(CloseButton, tweenInfo, {
        BackgroundColor3 = Color3.fromRGB(40, 0, 0),
        TextColor3 = theme.red
    })
    tween:Play()
end)

ThemeToggleButton.MouseButton1Click:Connect(function()
    toggleHackerVision()
end)

AdvancedButton.MouseButton1Click:Connect(function()
    StatusLabel.Text = "é«˜çº§é»‘å®¢å·¥å…· (å¼€å‘ä¸­)"
    print("ğŸ”§ é«˜çº§åŠŸèƒ½æš‚æœªå¼€å‘")
end)

-- æ·»åŠ é”®ç›˜å¿«æ·é”®
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if not gameProcessed then
        if input.KeyCode == Enum.KeyCode.H then
            toggleHackerVision()
        elseif input.KeyCode == Enum.KeyCode.B then
            MainFrame.Visible = not MainFrame.Visible
            print(MainFrame.Visible and "ğŸ”“ é»‘å®¢èœå•å·²æ˜¾ç¤º" or "ğŸ”’ é»‘å®¢èœå•å·²éšè—")
        elseif input.KeyCode == Enum.KeyCode.M then
            toggleMinimize()
        end
    end
end)

-- æ·»åŠ UIæ˜¾ç¤º/éšè—æ§åˆ¶
local function showMenu()
    ScreenGui.Enabled = true
    MainFrame.Visible = true
    print("ğŸ”“ é»‘å®¢èœå•å·²æ˜¾ç¤º")
end

local function hideMenu()
    ScreenGui.Enabled = false
    print("ğŸ”’ é»‘å®¢èœå•å·²éšè—")
end

-- åˆå§‹åŒ–å®Œæˆæç¤º
print("==================================")
print("âœ… é»‘å®¢èœå• - é»‘æ ¸çº¢è¾¹å‘å…‰è§†è§‰ç³»ç»Ÿ")
print("âœ… ä¿®å¤ç‰ˆ - å¯æ³¨å…¥è¿è¡Œ")
print("")
print("ğŸ“‹ ç³»ç»ŸåŠŸèƒ½:")
print("â€¢ ğŸ’» é»‘å®¢è§†è§‰åˆ‡æ¢ (Hé”®)")
print("â€¢ ğŸ“± çª—å£ç¼©æ”¾ (Mé”®)")
print("â€¢ ğŸ”’ éšè—/æ˜¾ç¤º (Bé”®)")
print("â€¢ âš™ï¸ å…‰æ™•å¼ºåº¦æ§åˆ¶")
print("â€¢ ğŸ¯ é»‘æ ¸çº¢è¾¹ç²’å­ç‰¹æ•ˆ")
print("â€¢ ğŸ”§ é«˜çº§å·¥å…·æ¥å£")
print("")
print("ğŸš€ ç³»ç»ŸçŠ¶æ€: å°±ç»ª")
print("==================================")
print("")
print("ğŸ’¡ æç¤º: ç‚¹å‡»'å¯åŠ¨é»‘å®¢è§†è§‰'å¼€å§‹æ•ˆæœ")
print("ğŸ’¡ æç¤º: ä½¿ç”¨æ»‘å—è°ƒæ•´å…‰æ™•å¼ºåº¦")
print("ğŸ’¡ æç¤º: æ‹–åŠ¨æ ‡é¢˜æ ç§»åŠ¨çª—å£")
print("==================================")

-- ç¡®ä¿UIå¯è§
ScreenGui.Enabled = true
MainFrame.Visible = true
